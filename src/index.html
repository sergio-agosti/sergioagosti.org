<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Sergio Agosti - Open-source web developer specializing in accessible, performant websites and web applications"
    />
    <title>Sergio Agosti - Open-source Web Developer</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet" />
    <link href="./style.css" rel="stylesheet" />
    <script>
      (() => {
        const html = document.documentElement;
        const prefersDarkMediaQuery = window.matchMedia("(prefers-color-scheme: dark)");
        const prefersDark = prefersDarkMediaQuery.matches;

        let currentTheme = localStorage.getItem("theme") || null;

        function applyTheme(theme) {
          switch (theme) {
            case "dark":
              html.classList.add("dark");
              break;
            case "light":
              html.classList.remove("dark");
              break;
            default:
              html.classList.toggle("dark", prefersDark);
              break;
          }
        }

        applyTheme(currentTheme);

        document.addEventListener("DOMContentLoaded", () => {
          // Email obfuscation - decode and set email link
          (() => {
            const emailLink = document.getElementById("email-link");

            if (emailLink) {
              emailLink.textContent = atob(emailLink.dataset.email);
              emailLink.href = `mailto:${emailLink.textContent}`;
            }
          })();

          // Theme toggle - cycle through light, dark, auto
          (() => {
            const sunIcon = document.getElementById("sun-icon");
            const moonIcon = document.getElementById("moon-icon");
            const systemIcon = document.getElementById("system-icon");
            const themeToggle = document.getElementById("theme-toggle");

            function updateIcon() {
              sunIcon.classList.add("hidden");
              moonIcon.classList.add("hidden");
              systemIcon.classList.add("hidden");

              switch (currentTheme) {
                case "light":
                  sunIcon.classList.remove("hidden");
                  break;
                case "dark":
                  moonIcon.classList.remove("hidden");
                  break;
                default:
                  systemIcon.classList.remove("hidden");
              }
            }

            updateIcon();

            prefersDarkMediaQuery.addEventListener("change", (e) => {
              currentTheme = e.matches ? "dark" : "light";
              localStorage.removeItem("theme");
              applyTheme(currentTheme);
              updateIcon();
            });

            themeToggle.addEventListener("click", () => {
              // Cycle: light -> dark -> auto -> light
              switch (currentTheme) {
                case "light":
                  currentTheme = "dark";
                  break;
                case "dark":
                  currentTheme = null;
                  break;
                default:
                  currentTheme = "light";
                  break;
              }

              currentTheme ? localStorage.setItem("theme", currentTheme) : localStorage.removeItem("theme");
              applyTheme(currentTheme);
              updateIcon();
            });
          })();
        });
      })();
    </script>
  </head>
  <body
    class="min-h-svh place-content-center bg-gray-100 font-mono text-base text-pretty text-gray-900 transition dark:bg-gray-900 dark:text-gray-100"
  >
    <nav aria-label="Theme preferences">
      <button
        id="theme-toggle"
        class="flex fixed top-6 right-6 rounded-md border-none bg-transparent p-2 text-gray-600 transition hover:bg-gray-200 hover:text-current dark:text-gray-400 dark:hover:bg-gray-800"
        aria-label="Toggle theme"
        type="button"
      >
        <svg id="sun-icon" class="hidden size-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
          />
        </svg>
        <svg id="moon-icon" class="hidden size-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
          />
        </svg>
        <svg id="system-icon" class="hidden size-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
          />
        </svg>
      </button>
    </nav>
    <header class="container my-8 space-y-2 md:my-16">
      <h1 class="text-4xl text-teal-600 transition dark:text-teal-400">Sergio Agosti</h1>
      <p class="text-lg">Open-source web developer</p>
    </header>
    <main class="container my-8 space-y-16 md:my-16">
      <section aria-labelledby="about-heading" class="space-y-4">
        <h2 id="about-heading" class="sr-only">About</h2>
        <p>
          I develop accessible, high-performance websites and web applications using open-source technologies, with
          thoughtful use of AI.
        </p>
        <p>
          With over <time datetime="P15Y">15 years</time> of experience, my work focuses on code quality, best
          practices, and long-term maintainability.
        </p>
      </section>
      <section aria-labelledby="contact-heading" class="space-y-4">
        <h2 id="contact-heading" class="sr-only">Contact</h2>
        <p>I'm available for projects and collaboration.</p>
        <address class="not-italic">
          <a id="email-link" data-email="bWVAc2VyZ2lvYWdvc3RpLm9yZw==" rel="me">&nbsp;</a>
        </address>
      </section>
    </main>
  </body>
</html>
